<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Korean Blog</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #ffffff;
      --surface: #f9f9f9;
      --border: #e8e8e8;
      --text: #1a1a1a;
      --muted: #888888;
      --accent: #2563eb;
      --card: #ffffff;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Nanum Gothic', sans-serif;
      line-height: 1.7;
      min-height: 100vh;
    }
    header {
      position: sticky; top: 0; z-index: 100;
      background: #ffffff;
      border-bottom: 2px solid var(--text);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 2.5rem; height: 58px;
    }
    .logo { font-family: 'Nanum Gothic', sans-serif; font-weight: 800; font-size: 1.1rem; color: var(--text); text-decoration: none; }
    .logo span { color: var(--accent); }
    nav { display: flex; align-items: center; gap: 2rem; }
    nav a { font-size: 0.85rem; color: var(--muted); text-decoration: none; font-weight: 700; transition: color 0.2s; }
    nav a:hover { color: var(--text); }
    .post-count { font-size: 0.75rem; color: var(--accent); border: 1px solid var(--accent); padding: 0.2rem 0.7rem; font-weight: 700; }
    .hero {
      max-width: 1100px; margin: 0 auto; padding: 6rem 2.5rem 4rem;
      border-bottom: 1px solid var(--border);
      opacity: 0; transform: translateY(20px);
      animation: fadeUp 0.7s ease forwards 0.1s;
    }
    .hero-label {
      font-size: 0.75rem; font-weight: 700; letter-spacing: 0.2em; color: var(--accent);
      text-transform: uppercase; margin-bottom: 1.2rem;
      display: flex; align-items: center; gap: 0.8rem;
    }
    .hero-label::before { content: ''; width: 28px; height: 2px; background: var(--accent); }
    .hero h1 {
      font-family: 'Nanum Myeongjo', serif; font-size: clamp(2.2rem, 5vw, 4rem);
      font-weight: 800; line-height: 1.2; letter-spacing: -0.02em; margin-bottom: 1.5rem;
    }
    .hero h1 em { font-style: normal; color: var(--accent); border-bottom: 3px solid var(--accent); }
    .hero p { font-size: 1rem; color: var(--muted); max-width: 500px; }
    .filter-bar {
      max-width: 1100px; margin: 0 auto; padding: 1.5rem 2.5rem;
      display: flex; gap: 0.5rem; flex-wrap: wrap;
      border-bottom: 1px solid var(--border);
      opacity: 0; animation: fadeUp 0.7s ease forwards 0.25s;
    }
    .filter-btn {
      font-family: 'Nanum Gothic', sans-serif; font-size: 0.8rem; font-weight: 700;
      padding: 0.35rem 1rem; border: 1px solid var(--border);
      background: none; color: var(--muted); cursor: pointer; transition: all 0.15s;
    }
    .filter-btn:hover { border-color: var(--text); color: var(--text); }
    .filter-btn.active { background: var(--text); border-color: var(--text); color: #fff; }
    .grid {
      max-width: 1100px; margin: 0 auto; padding: 2rem 2.5rem 6rem;
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;
    }
    .post-card {
      background: var(--card); border: 1px solid var(--border);
      padding: 1.8rem; cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
      opacity: 0; animation: fadeUp 0.5s ease forwards;
      display: flex; flex-direction: column;
    }
    .post-card:hover { border-color: var(--accent); box-shadow: 0 4px 24px rgba(37,99,235,0.08); transform: translateY(-3px); }
    .post-card.featured { grid-column: span 2; }
    .card-top { display: flex; align-items: center; gap: 0.7rem; margin-bottom: 1rem; }
    .card-category {
      font-size: 0.7rem; font-weight: 800; letter-spacing: 0.12em; text-transform: uppercase;
      color: var(--accent); background: rgba(37,99,235,0.07);
      border: 1px solid rgba(37,99,235,0.15); padding: 0.15rem 0.55rem;
    }
    .card-date { font-size: 0.72rem; color: var(--muted); }
    .card-title { font-family: 'Nanum Myeongjo', serif; font-weight: 700; font-size: 1.1rem; line-height: 1.4; margin-bottom: 0.7rem; }
    .post-card.featured .card-title { font-size: 1.4rem; }
    .card-excerpt { font-size: 0.88rem; color: var(--muted); line-height: 1.7; margin-bottom: 1.2rem; flex: 1; }
    .card-tags { display: flex; gap: 0.4rem; flex-wrap: wrap; margin-bottom: 1rem; }
    .tag { font-size: 0.7rem; color: var(--muted); border: 1px solid var(--border); padding: 0.1rem 0.45rem; }
    .card-read {
      font-size: 0.78rem; font-weight: 700; color: var(--muted);
      display: flex; align-items: center; gap: 0.3rem;
      transition: color 0.2s, gap 0.2s;
      border-top: 1px solid var(--border); padding-top: 0.9rem;
    }
    .post-card:hover .card-read { color: var(--accent); gap: 0.6rem; }
    .modal-overlay {
      display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5);
      z-index: 500; align-items: center; justify-content: center;
      padding: 2rem 1rem; overflow-y: auto;
    }
    .modal-overlay.open { display: flex; }
    .modal {
      background: #fff; max-width: 700px; width: 100%; margin: auto;
      border-top: 3px solid var(--accent); position: relative;
      animation: fadeUp 0.25s ease; max-height: 85vh; overflow-y: auto;
    }
    .modal-header { padding: 2.5rem 2.5rem 1.5rem; border-bottom: 1px solid var(--border); }
    .modal-body-content { padding: 2rem 2.5rem 3rem; font-size: 0.95rem; line-height: 2; color: #333; white-space: pre-wrap; }
    .modal-close {
      position: absolute; top: 1.2rem; right: 1.2rem;
      background: none; border: 1px solid var(--border); color: var(--muted);
      width: 32px; height: 32px; font-size: 1rem; cursor: pointer;
      display: flex; align-items: center; justify-content: center; transition: all 0.15s;
    }
    .modal-close:hover { border-color: var(--text); color: var(--text); }
    .modal-title { font-family: 'Nanum Myeongjo', serif; font-size: 1.6rem; font-weight: 800; line-height: 1.3; margin-top: 0.8rem; }
    .empty { grid-column: span 3; padding: 5rem; text-align: center; color: var(--muted); font-size: 0.9rem; display: none; }
    .empty.show { display: block; }
    .loading { grid-column: span 3; padding: 4rem; text-align: center; font-size: 0.85rem; color: var(--muted); }
    footer { background: var(--text); color: rgba(255,255,255,0.5); display: flex; justify-content: space-between; align-items: center; padding: 1.5rem 2.5rem; font-size: 0.78rem; }
    footer span { color: rgba(255,255,255,0.8); }
    @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
    @media (max-width: 768px) {
      .post-card, .post-card.featured { grid-column: span 3; }
      .grid { grid-template-columns: 1fr; }
      .empty, .loading { grid-column: span 1; }
    }
  </style>
</head>
<body>

<header>
  <a href="#" class="logo">KOREAN<span>BLOG</span></a>
  <nav>
    <a href="#">홈</a>
    <a href="#posts">포스트</a>
    <span class="post-count" id="post-count">0개의 글</span>
  </nav>
</header>

<section class="hero">
  <p class="hero-label">AI 자동 발행 블로그</p>
  <h1>생각을 기록하고<br><em>세상과 나눕니다</em></h1>
  <p>Gemini가 작성하고 n8n이 자동 발행하는 블로그입니다.<br>매일 새로운 글이 올라옵니다.</p>
</section>

<div class="filter-bar" id="filter-bar">
  <button class="filter-btn active" data-filter="all" onclick="filterPosts('all', this)">전체</button>
</div>

<div class="grid" id="posts-grid">
  <div class="loading">글을 불러오는 중...</div>
</div>

<div class="modal-overlay" id="read-modal" onclick="handleOverlayClick(event)">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">✕</button>
    <div class="modal-header">
      <div class="card-top">
        <span class="card-category" id="m-category"></span>
        <span class="card-date" id="m-date"></span>
      </div>
      <div class="modal-title" id="m-title"></div>
      <div class="card-tags" id="m-tags" style="margin-top:0.7rem;"></div>
    </div>
    <div class="modal-body-content" id="m-body"></div>
  </div>
</div>

<footer>
  <span>Korean Blog — Powered by n8n × GitHub Pages</span>
  <span id="footer-updated"></span>
</footer>

<script>
  let allPosts = [];

  async function loadPosts() {
    try {
      const res = await fetch('posts.json?t=' + Date.now());
      if (!res.ok) throw new Error();
      allPosts = await res.json();
      init();
    } catch(e) {
      document.getElementById('posts-grid').innerHTML = '<div class="loading" style="color:red;">posts.json을 불러올 수 없습니다.</div>';
    }
  }

  function init() {
    buildFilters();
    renderPosts(allPosts);
    document.getElementById('post-count').textContent = allPosts.length + '개의 글';
    const latest = [...allPosts].reverse()[0];
    if (latest) document.getElementById('footer-updated').textContent = 'Last updated: ' + latest.date;
  }

  function buildFilters() {
    const cats = [...new Set(allPosts.map(p => p.category).filter(Boolean))];
    const bar = document.getElementById('filter-bar');
    cats.forEach(cat => {
      const btn = document.createElement('button');
      btn.className = 'filter-btn';
      btn.textContent = cat;
      btn.onclick = () => filterPosts(cat, btn);
      bar.appendChild(btn);
    });
  }

  function filterPosts(filter, btn) {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const filtered = filter === 'all' ? allPosts : allPosts.filter(p => p.category === filter);
    renderPosts(filtered);
  }

  function renderPosts(posts) {
    const grid = document.getElementById('posts-grid');
    grid.innerHTML = '';
    if (!posts.length) { grid.innerHTML = '<div class="empty show">글이 없습니다.</div>'; return; }
    [...posts].reverse().forEach((post, i) => {
      const card = document.createElement('div');
      card.className = 'post-card' + (i === 0 ? ' featured' : '');
      card.style.animationDelay = (0.05 + i * 0.07) + 's';
      card.innerHTML = `
        <div class="card-top">
          <span class="card-category">${post.category||'기타'}</span>
          <span class="card-date">${formatDate(post.date)}</span>
        </div>
        <div class="card-title">${post.title}</div>
        <div class="card-excerpt">${post.excerpt||''}</div>
        <div class="card-tags">${(post.tags||[]).map(t=>`<span class="tag">#${t}</span>`).join('')}</div>
        <div class="card-read">읽기 →</div>
      `;
      card.onclick = () => openModal(post);
      grid.appendChild(card);
    });
  }

  function formatDate(d) {
    if (!d) return '';
    const dt = new Date(d);
    return `${dt.getFullYear()}.${String(dt.getMonth()+1).padStart(2,'0')}.${String(dt.getDate()).padStart(2,'0')}`;
  }

  function openModal(post) {
    document.getElementById('m-category').textContent = post.category||'';
    document.getElementById('m-date').textContent = formatDate(post.date);
    document.getElementById('m-title').textContent = post.title;
    document.getElementById('m-body').textContent = post.content||'';
    document.getElementById('m-tags').innerHTML = (post.tags||[]).map(t=>`<span class="tag">#${t}</span>`).join('');
    document.getElementById('read-modal').classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    document.getElementById('read-modal').classList.remove('open');
    document.body.style.overflow = '';
  }

  function handleOverlayClick(e) { if (e.target === e.currentTarget) closeModal(); }

  loadPosts();
</script>
</body>
</html>
